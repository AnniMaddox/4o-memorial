import{r as c,j as e,g as We}from"./index-5T63cCVV.js";import{S as se}from"./SettingsAccordion-CeOEURjl.js";const Be="/4o-memorial/docs/assets/1-CIu0cLBy.png",Pe="/4o-memorial/docs/assets/2-CxFzp3LM.png",ke="memorial-m-diary-favorites-v1",Se="memorial-m-diary-reading-font-mode-v1";function Ke(){if(typeof window>"u")return"default";try{return window.localStorage.getItem(Se)==="diary"?"diary":"default"}catch{return"default"}}const Ue=1440*60*1e3,Je=Object.assign({"../../public/diary-covers/1.png":Be,"../../public/diary-covers/2.png":Pe}),Ve=Object.values(Je),Qe=["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"],Ge=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],je=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],X=["random","timeline","reading"];function re(a){return a.length?a[Math.floor(Math.random()*a.length)]:null}function qe(a){return Number.isFinite(a)?Math.max(1.5,Math.min(2.8,a??2.16)):2.16}function Xe(a){return Number.isFinite(a)?Math.max(12,Math.min(22,Number(a))):14}function ve(a,s=144){return Number.isFinite(a)?Math.max(104,Math.min(196,Math.round(a??s))):s}function le(a){return a.replace(/\u00a0/g," ").replace(/\r/g,"").replace(/[\t\f\v]+/g," ").replace(/\n{3,}/g,`

`).trim()}function Ze(a){if(!a.trim())return"";if(typeof document>"u")return le(a.replace(/<br\s*\/?\s*>/gi,`
`).replace(/<\/p\s*>/gi,`
`).replace(/<\/div\s*>/gi,`
`).replace(/<[^>]+>/g," "));const s=document.createElement("div");return s.innerHTML=a,s.querySelectorAll("br").forEach(i=>{i.replaceWith(document.createTextNode(`
`))}),s.querySelectorAll("p,div,section,article,li,h1,h2,h3,h4,h5,h6").forEach(i=>{i.textContent?.trim()&&i.appendChild(document.createTextNode(`
`))}),le(s.textContent??"")}function et(a){return a.split(/\n+/).map(s=>s.replace(/[\u200b\u200c\u200d]/g,"").trim()).filter(s=>s.length>0)}function tt(a){return a.replace(/\.(txt|docx?)$/i,"").trim()}function we(a,s,r){if(s<1||s>12||r<1||r>31)return null;const i=new Date(a,s-1,r);return i.getFullYear()!==a||i.getMonth()!==s-1||i.getDate()!==r?null:(i.setHours(0,0,0,0),i)}function Ce(a){const s=a.trim();if(!s)return null;const r=[/(?:^|[^\d])(19\d{2}|20\d{2})[\s_.\/-]*å¹´?[\s_.\/-]*(1[0-2]|0?[1-9])[\s_.\/-]*æœˆ?[\s_.\/-]*(3[01]|[12]\d|0?[1-9])\s*æ—¥?(?=$|[^\d])/,/(?:^|[^\d])(19\d{2}|20\d{2})(1[0-2]|0[1-9])(3[01]|[12]\d|0[1-9])(?=$|[^\d])/];for(const m of r){const u=s.match(m);if(!u)continue;const k=Number(u[1]),N=Number(u[2]),M=Number(u[3]),F=we(k,N,M);if(F)return F}const i=/(?:^|[^\d])(1[0-2]|0?[1-9])[\/.\-](3[01]|[12]\d|0?[1-9])[\/.\-](19\d{2}|20\d{2})(?=$|[^\d])/,d=s.match(i);if(d){const m=Number(d[1]),u=Number(d[2]),k=Number(d[3]),N=we(k,m,u);if(N)return N}return null}function at(a){for(const s of a){const r=Ce(s);if(r)return r}return null}function nt(a){const{entryName:s,baseTitle:r,entryTitle:i,lines:d}=a,m=d.slice(0,2),u=d.slice(-2),k=[s,r,i,...m,...u],N=new Set,M=[];for(const F of k){const T=F.trim();!T||N.has(T)||(N.add(T),M.push(T))}return M}function De(a){return Ce(a)?a.replace(/[\s\då¹´æœˆæ—¥\/.\-_:ï¼š()ï¼ˆï¼‰æ˜ŸæœŸç¦®æ‹œä¸€äºŒä¸‰å››äº”å…­æ—¥å¤©]/g,"").length<=2:!1}function st(a,s){const r=s.find(d=>!De(d));if(r&&r.length<=42)return r;const i=a.replace(/(?:19\d{2}|20\d{2})[\s_.\/-]*å¹´?[\s_.\/-]*(?:1[0-2]|0?[1-9])[\s_.\/-]*æœˆ?[\s_.\/-]*(?:3[01]|[12]\d|0?[1-9])\s*æ—¥?/g,"").replace(/[._\-]+/g," ").replace(/\s{2,}/g," ").trim();return i||a||"æœªå‘½åæ—¥è¨˜"}function rt(a,s,r){const i=a.filter(m=>m!==s&&!De(m)),d=(i.length?i.join(" "):r).replace(/\s+/g," ").trim();return d?d.length>56?`${d.slice(0,56)}...`:d:"ï¼ˆæ²’æœ‰å…§å®¹ï¼‰"}function lt(a,s){if(!a.parsedDate)return"??";const r=a.parsedDate.getMonth()+1,i=a.parsedDate.getDate(),d=Qe[a.parsedDate.getDay()];return s>1?`${r}æœˆ ${i}æ—¥ï¼ˆ${d}ï¼‰ Â· åŒæ—¥ç¬¬ ${s} ç¯‡`:`${r}æœˆ ${i}æ—¥ï¼ˆ${d}ï¼‰`}function it(a){return a.parsedDate?`${a.parsedDate.getFullYear()}å¹´ ${a.parsedDate.getMonth()+1}æœˆ`:"æœªçŸ¥æ™‚åˆ»"}function ot(a){if(!a.length)return"æ²’æœ‰å¯è§£ææ—¥æœŸ";const s=a.filter(u=>u.parsedDate instanceof Date).map(u=>u.parsedDate.getTime());if(!s.length)return"æ²’æœ‰å¯è§£ææ—¥æœŸ";const r=new Date(Math.min(...s)),i=new Date(Math.max(...s)),d=`${r.getFullYear()}å¹´${r.getMonth()+1}æœˆ`,m=`${i.getFullYear()}å¹´${i.getMonth()+1}æœˆ`;return d===m?d:`${d}â€”${m}`}function ct(a,s){const r=new Date(a),i=new Date(s);return r.setHours(0,0,0,0),i.setHours(0,0,0,0),Math.round(Math.abs(r.getTime()-i.getTime())/Ue)}function dt(){if(typeof window>"u")return new Set;try{const a=window.localStorage.getItem(ke);if(!a)return new Set;const s=JSON.parse(a);return Array.isArray(s)?new Set(s.filter(r=>typeof r=="string")):new Set}catch{return new Set}}function pt(a){typeof window>"u"||window.localStorage.setItem(ke,JSON.stringify(Array.from(a)))}function xt(){const a=We("mdiary");return re(a)??""}function bt({entries:a,onExit:s,diaryCoverImageUrl:r="",diaryCoverFitMode:i="cover",diaryFontFamily:d="",mDiaryLineHeight:m=2.16,mDiaryContentFontSize:u=14,mDiaryShowCount:k=!0,mDiaryRandomChibiWidth:N=144,mDiaryReadingChibiWidth:M=144,mDiaryShowReadingChibi:F=!0,onSettingChange:T}){const[b,Y]=c.useState("random"),[x,Z]=c.useState("all"),[ie,oe]=c.useState(""),[v,Me]=c.useState(!1),[S,Fe]=c.useState("desc"),[C,E]=c.useState(null),[ce,z]=c.useState(!1),[ee,te]=c.useState({count:!1,text:!1,chibi:!1}),[j,Te]=c.useState(()=>dt()),[de]=c.useState(xt),[pe]=c.useState(()=>re(Ve)??""),[P,Ee]=c.useState(!1),[K,ze]=c.useState(Ke),Re=c.useRef(null),xe=c.useRef(null),U=c.useRef(null),ue="var(--app-font-family, -apple-system, BlinkMacSystemFont, 'Helvetica Neue', sans-serif)",O=d||ue,me=K==="diary"?O:ue,R=qe(m),A=Xe(u),_=!!k,I=ve(N,144),H=ve(M,144),J=!!F,$=c.useMemo(()=>a.map(t=>{const n=tt(t.name)||t.title?.trim()||"æœªå‘½åæ—¥è¨˜",l=le(t.content||Ze(t.htmlContent||"")),p=et(l),y=nt({entryName:t.name,baseTitle:n,entryTitle:t.title??"",lines:p}),g=at(y),Q=st(n,p),G=rt(p,Q,l);return{name:t.name,title:Q,text:l,htmlContent:t.htmlContent,parsedDate:g,dayKey:g?g.toISOString().slice(0,10):null,snippet:G,importedAt:t.importedAt,source:t}}),[a]),be=c.useMemo(()=>$.filter(t=>!!(t.parsedDate&&t.dayKey)),[$]),fe=c.useMemo(()=>$.filter(t=>!t.parsedDate),[$]),W=c.useMemo(()=>{const t=[...be];return t.sort((n,l)=>{const p=n.parsedDate.getTime()-l.parsedDate.getTime();if(p!==0)return S==="asc"?p:-p;const y=n.importedAt-l.importedAt;return y!==0?S==="asc"?y:-y:n.name.localeCompare(l.name,"zh-TW")}),t},[be,S]),L=c.useMemo(()=>{const t=[...fe];return t.sort((n,l)=>{const p=n.importedAt-l.importedAt;return p!==0?S==="asc"?p:-p:n.name.localeCompare(l.name,"zh-TW")}),t},[fe,S]),D=ie.trim().toLowerCase(),ge=t=>{if(!D)return!0;const n=t.parsedDate?t.parsedDate.toISOString().slice(0,10):"æœªçŸ¥æ™‚åˆ»";return`${t.title}
${t.snippet}
${t.text}
${t.name}
${n}`.toLowerCase().includes(D)},V=c.useMemo(()=>[...W,...L],[W,L]),h=c.useMemo(()=>x==="unknown"?[]:(x==="favorites"?W.filter(n=>j.has(n.name)):W).filter(ge),[x,W,j,D]),B=c.useMemo(()=>(x==="unknown"?L:x==="favorites"?L.filter(n=>j.has(n.name)):L).filter(ge),[x,L,j,D]),f=c.useMemo(()=>{const t=[...h,...B];return t.length?t:x==="all"&&!D?V:[]},[h,B,V,x,D]),he=c.useMemo(()=>{const t=new Map;for(const n of $)t.set(n.name,n);return t},[$]),o=c.useMemo(()=>{if(!f.length)return null;if(C){const t=f.find(n=>n.name===C)??he.get(C);if(t)return t}return f[0]??null},[f,C,he]),ae=c.useMemo(()=>o?f.findIndex(t=>t.name===o.name):-1,[o,f]);c.useEffect(()=>{o&&o.name!==C&&E(o.name),!o&&C&&E(null)},[o,C]),c.useEffect(()=>{if(typeof window>"u")return;const t=o?.name;if(!t||b!=="reading")return;document.getElementById(`m-diary-chip-${encodeURIComponent(t)}`)?.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[o?.name,b]),c.useEffect(()=>{v&&xe.current?.focus()},[v]);function Ae(){const t=re(V);t&&(E(t.name),Y("reading"),z(!1))}function ye(t){E(t.name),Y("reading"),z(!1)}function _e(t){Te(n=>{const l=new Set(n);return l.has(t)?l.delete(t):l.add(t),pt(l),l})}function ne(t){if(!f.length)return;const l=((ae>=0?ae:0)+t+f.length)%f.length,p=f[l];p&&E(p.name)}function $e(t){return t instanceof HTMLElement&&!!t.closest('[data-mdiary-no-tab-swipe="true"]')}function Le(t,n,l){U.current={x:t,y:n,ignore:ce||$e(l)}}function Ye(){U.current=null}function Oe(t,n){const l=U.current;if(U.current=null,!l||l.ignore)return;const p=t-l.x,y=n-l.y;if(Math.abs(p)<54||Math.abs(p)<=Math.abs(y))return;if(b==="reading"){ne(p>0?-1:1);return}const g=X.indexOf(b);g!==-1&&(p<0&&g<X.length-1?Y(X[g+1]):p>0&&g>0&&Y(X[g-1]))}function w(t){T?.(t)}const Ne=h.length+B.length,Ie=e.jsx("header",{className:"shrink-0 border-b px-4 pb-2.5 pt-3",style:{borderColor:"rgba(80,100,70,0.08)",background:"#f6f2ea"},children:e.jsxs("div",{className:"flex items-end justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("button",{type:"button",onClick:s,className:"grid h-[30px] w-[30px] place-items-center rounded-full border text-[15px] transition active:scale-95",style:{background:"rgba(255,255,255,0.7)",borderColor:"rgba(80,100,70,0.16)",color:"#5a7060"},"aria-label":"è¿”å›",children:"â€¹"}),e.jsx("span",{className:"font-semibold tracking-[0.02em] text-[#2a2818]",style:{fontSize:"var(--ui-header-title-size, 17px)",fontFamily:"var(--app-font-family, -apple-system, 'Helvetica Neue', system-ui, sans-serif)"},children:"M çš„æ—¥è¨˜"})]}),e.jsx("button",{type:"button",onClick:()=>z(!0),className:"px-1 text-[18px] leading-none",style:{color:"rgba(80,100,70,0.36)"},"aria-label":"é–‹å•Ÿè¨­å®š",children:"â‹¯"})]})});return e.jsxs("div",{className:"relative flex h-full flex-col overflow-hidden",style:{background:"#f6f2ea"},onTouchStart:t=>{const n=t.touches[0];n&&Le(n.clientX,n.clientY,t.target)},onTouchEnd:t=>{const n=t.changedTouches[0];n&&Oe(n.clientX,n.clientY)},onTouchCancel:Ye,children:[Ie,e.jsxs("div",{className:"shrink-0 px-4 pt-1",children:[e.jsx("div",{className:"flex",children:[["random","éš¨æ©Ÿ"],["timeline","æ™‚é–“æµ"],["reading","é–±è®€"]].map(([t,n])=>{const l=b===t;return e.jsx("button",{type:"button",onClick:()=>{Y(t),z(!1)},className:"flex-1 border-b text-center transition",style:{padding:"9px 0 7px",fontSize:"var(--ui-tab-label-size, 17px)",lineHeight:1.2,fontWeight:500,letterSpacing:"0.04em",color:l?"#5a7060":"#9aaa98",borderBottomColor:l?"#5a7060":"rgba(80,100,70,0.09)",borderBottomWidth:2,fontFamily:"var(--app-font-family, -apple-system, 'Helvetica Neue', system-ui, sans-serif)"},children:n},t)})}),e.jsx("p",{className:"pb-1 pt-0.5 text-center text-[8px] tracking-[0.12em]",style:{color:"rgba(90,112,96,0.25)"},children:"â† å·¦å³åˆ‡æ›é ç±¤ â†’"})]}),b==="random"&&e.jsxs("div",{className:"relative flex-1 overflow-hidden",style:{backgroundImage:"repeating-linear-gradient(to bottom, transparent, transparent 31px, rgba(80,100,70,0.038) 31px, rgba(80,100,70,0.038) 32px)"},children:[e.jsx("div",{className:"pointer-events-none absolute bottom-0 left-[52px] top-0 w-px",style:{background:"rgba(90,112,96,0.1)"}}),e.jsxs("div",{className:"flex h-full flex-col items-center justify-start px-4 pt-7",children:[e.jsx("button",{type:"button",onClick:Ae,className:"group relative mt-1 transition active:scale-[0.98]",style:{filter:"drop-shadow(0 24px 48px rgba(30,20,10,0.45))"},children:e.jsxs("div",{className:"relative h-[268px] w-[210px]",children:[e.jsx("div",{className:"absolute bottom-0 left-0 top-0 w-[22px] rounded-l",style:{background:"linear-gradient(to right, #1e2e24, #2e3d32 60%, #3a4f44)"}}),e.jsxs("div",{className:"absolute inset-y-0 left-[18px] right-0 overflow-hidden rounded-r-[12px]",style:{background:r?"linear-gradient(145deg, #5b5b5b 0%, #3f3f3f 100%)":"linear-gradient(145deg, #5a7060 0%, #4d6355 45%, #3d5045 100%)"},children:[r?e.jsx(e.Fragment,{children:i==="cover"?e.jsx("img",{src:r,alt:"",draggable:!1,className:"absolute inset-0 h-full w-full object-cover"}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:r,alt:"",draggable:!1,className:"absolute inset-0 h-full w-full object-cover opacity-35 blur-xl"}),e.jsx("img",{src:r,alt:"",draggable:!1,className:"absolute inset-0 h-full w-full object-contain p-3"})]})}):pe?e.jsx("img",{src:pe,alt:"",draggable:!1,className:"absolute inset-0 h-full w-full object-cover opacity-35"}):null,e.jsx("div",{className:"pointer-events-none absolute inset-[13px]",style:{border:"1px solid rgba(195,178,130,0.22)"}}),e.jsx("div",{className:"absolute left-1/2 top-1/2 z-10 w-[120px] -translate-x-1/2 -translate-y-1/2 text-center",children:e.jsxs("p",{className:"text-[20px] leading-[1.65] tracking-[0.06em] text-[#d7c8a5bf]",style:{fontFamily:O},children:["M's",e.jsx("br",{}),"ç§è—æ—¥è¨˜"]})})]}),e.jsx("div",{className:"absolute bottom-[6px] right-[-5px] top-[6px] w-[14px] rounded-r-[3px]",style:{background:"repeating-linear-gradient(to right, #e8e0d4 0, #e8e0d4 1px, #f0e8dc 1px, #f0e8dc 3.5px)"}}),e.jsx("div",{className:"absolute bottom-[-18px] right-[52px] z-[2] h-[36px] w-[11px]",style:{background:"linear-gradient(to bottom, #be4040, #982828)",boxShadow:"0 4px 10px rgba(180,40,40,0.35)"},children:e.jsx("div",{className:"absolute bottom-[-9px] left-0 right-0 h-[9px]",style:{background:"#982828",clipPath:"polygon(0 0, 100% 0, 50% 100%)"}})})]})}),_&&e.jsxs("p",{className:"mt-7 text-[10px] tracking-[0.12em]",style:{color:"rgba(90,112,96,0.3)"},children:["å…± ",V.length," ç¯‡"]})]})]}),b==="timeline"&&e.jsxs("div",{className:"relative min-h-0 flex-1 overflow-y-auto pb-28",style:{scrollbarWidth:"none"},children:[e.jsx("div",{className:"absolute bottom-0 left-[38px] top-0 w-[1.5px]",style:{background:"rgba(90,112,96,0.13)"}}),e.jsxs("div",{className:"sticky top-0 z-10 bg-[#f6f2ea]/95 px-4 pb-1 pt-1 backdrop-blur",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 pl-10",children:[e.jsx("button",{type:"button",onClick:()=>Z("all"),className:"rounded-full border px-3 py-1 tracking-[0.04em]",style:{fontSize:"var(--ui-filter-pill-size, 10px)",color:x==="all"?"#5a7060":"#8a9a88",background:x==="all"?"rgba(90,112,96,0.1)":"transparent",borderColor:x==="all"?"rgba(90,112,96,0.3)":"rgba(90,112,96,0.18)"},children:"å…¨éƒ¨"}),e.jsx("button",{type:"button",onClick:()=>Z("favorites"),className:"rounded-full border px-3 py-1 tracking-[0.04em]",style:{fontSize:"var(--ui-filter-pill-size, 10px)",color:x==="favorites"?"#5a7060":"#8a9a88",background:x==="favorites"?"rgba(90,112,96,0.1)":"transparent",borderColor:x==="favorites"?"rgba(90,112,96,0.3)":"rgba(90,112,96,0.18)"},children:"æ”¶è—"}),e.jsx("button",{type:"button",onClick:()=>Z("unknown"),className:"rounded-full border px-3 py-1 tracking-[0.04em]",style:{fontSize:"var(--ui-filter-pill-size, 10px)",color:x==="unknown"?"#5a7060":"#8a9a88",background:x==="unknown"?"rgba(90,112,96,0.1)":"transparent",borderColor:x==="unknown"?"rgba(90,112,96,0.3)":"rgba(90,112,96,0.18)"},children:"æœªçŸ¥æ™‚åˆ»"}),e.jsx("button",{type:"button",onClick:()=>Fe(t=>t==="desc"?"asc":"desc"),className:"rounded-full border px-3 py-1 tracking-[0.04em]",style:{fontSize:"var(--ui-filter-pill-size, 10px)",color:"#5a7060",background:"rgba(90,112,96,0.08)",borderColor:"rgba(90,112,96,0.22)"},"aria-label":"åˆ‡æ›æ’åº",title:S==="desc"?"æ–°åˆ°èˆŠ":"èˆŠåˆ°æ–°",children:S==="desc"?"â†“":"â†‘"}),e.jsx("button",{type:"button",onClick:()=>Me(t=>{const n=!t;return n||oe(""),n}),className:"rounded-full border px-2.5 py-1 tracking-[0.04em]",style:{fontSize:"var(--ui-filter-pill-size, 10px)",color:v?"#5a7060":"#8a9a88",background:v?"rgba(90,112,96,0.12)":"transparent",borderColor:v?"rgba(90,112,96,0.3)":"rgba(90,112,96,0.18)"},"aria-label":v?"é—œé–‰æœå°‹":"é–‹å•Ÿæœå°‹",title:v?"é—œé–‰æœå°‹":"é–‹å•Ÿæœå°‹",children:"âŒ•"})]}),v?e.jsx("div",{className:"pt-1",style:{paddingLeft:52,paddingRight:16},children:e.jsx("input",{ref:xe,value:ie,onChange:t=>oe(t.target.value),placeholder:"æœå°‹æ¨™é¡Œã€å…§å®¹æˆ–æ—¥æœŸ",className:"w-full rounded-full border py-1.5 pl-3.5 pr-3 text-[11px] outline-none",style:{color:"#5a7060",background:"rgba(255,255,255,0.72)",borderColor:"rgba(90,112,96,0.2)"},"aria-label":"æœå°‹æ—¥è¨˜"})}):null,_&&e.jsxs("p",{className:"pt-1 tracking-[0.06em] text-[#9aaa98]",style:{paddingLeft:56,fontSize:"var(--ui-hint-text-size, 10px)"},children:["å…± ",Ne," ç¯‡ Â·"," ",x==="unknown"?"æœªçŸ¥æ™‚åˆ»":ot(h)]})]}),Ne===0?e.jsx("div",{className:"px-6 pt-20 text-center text-sm text-[#8a9a88]",children:D?"æ‰¾ä¸åˆ°ç¬¦åˆæœå°‹çš„æ—¥è¨˜":"é€™å€‹åˆ†é¡é‚„æ²’æœ‰æ—¥è¨˜"}):e.jsxs(e.Fragment,{children:[h.length>0&&h.map((t,n)=>{const l=h[n-1],p=h[n+1],y=!!(l&&l.dayKey===t.dayKey);let g=1;if(y){let q=n-1;for(;q>=0&&h[q]&&h[q].dayKey===t.dayKey;)g+=1,q-=1}const Q=!l||l.parsedDate.getMonth()!==t.parsedDate.getMonth()||l.parsedDate.getFullYear()!==t.parsedDate.getFullYear(),G=p?ct(t.parsedDate,p.parsedDate):0,He=j.has(t.name);return e.jsxs("div",{children:[Q&&e.jsxs("div",{className:"relative px-4 pb-2 pt-5 text-[9.5px] font-semibold uppercase tracking-[0.18em] text-[#8a9a88]",style:{paddingLeft:56},children:[e.jsx("span",{className:"absolute left-[34px] top-1/2 h-[9px] w-[9px] -translate-y-1/2 rounded-[2px]",style:{border:"1.5px solid #8a9a88",background:"#f6f2ea"}}),it(t)]}),e.jsxs("button",{type:"button",onClick:()=>ye(t),className:"flex w-full cursor-pointer items-start pr-4 text-left transition active:bg-[#5a70600d]",children:[e.jsxs("div",{className:"flex w-14 shrink-0 flex-col items-center pb-1 pt-4",children:[e.jsx("span",{className:"block rounded-full",style:y?{width:8,height:8,border:"1.5px solid #5a7060",background:"transparent"}:{width:10,height:10,background:"#5a7060",border:"2px solid #f6f2ea",boxShadow:"0 0 0 1.5px #5a7060"}}),e.jsx("span",{className:"mt-1 block min-h-3 w-[1.5px] flex-1",style:{background:"rgba(90,112,96,0.17)"}})]}),e.jsxs("div",{className:"flex-1 border-b py-3.5 pl-2",style:{borderColor:"rgba(80,100,70,0.06)"},children:[e.jsxs("p",{className:"mb-1 text-[9.5px] tracking-[0.07em] text-[#8a9a88]",children:[lt(t,g),He?e.jsx("span",{className:"ml-1 align-middle text-[11px] text-[#8a7050]",children:"â™¥"}):null]}),e.jsx("p",{className:"mb-1 text-[14px] font-semibold leading-[1.35] text-[#2a2818]",style:{fontFamily:O},children:t.title}),e.jsx("p",{className:"text-[12px] leading-[1.7] text-[#7a8870]",children:t.snippet})]})]}),G>0&&e.jsxs("div",{className:"flex items-center px-4 py-2",style:{paddingLeft:56},children:[e.jsx("span",{className:"h-px flex-1",style:{background:"rgba(90,112,96,0.11)"}}),e.jsxs("span",{className:"px-2.5 text-[9px] tracking-[0.1em]",style:{color:"rgba(90,112,96,0.4)"},children:["â”€â”€ ",G,"å¤©å¾Œ â”€â”€"]}),e.jsx("span",{className:"h-px flex-1",style:{background:"rgba(90,112,96,0.11)"}})]})]},t.name)}),B.length>0&&e.jsxs(e.Fragment,{children:[x!=="unknown"&&e.jsx("div",{className:"px-4 pb-2 pt-6 text-[9.5px] font-semibold uppercase tracking-[0.18em] text-[#8a9a88]",style:{paddingLeft:56},children:"æœªçŸ¥æ™‚åˆ»"}),B.map(t=>{const n=j.has(t.name);return e.jsxs("button",{type:"button",onClick:()=>ye(t),className:"flex w-full cursor-pointer items-start pr-4 text-left transition active:bg-[#5a70600d]",children:[e.jsxs("div",{className:"flex w-14 shrink-0 flex-col items-center pb-1 pt-4",children:[e.jsx("span",{className:"block h-[10px] w-[10px] rounded-full",style:{border:"1.5px solid #5a7060",background:"transparent"}}),e.jsx("span",{className:"mt-1 block min-h-3 w-[1.5px] flex-1",style:{background:"rgba(90,112,96,0.17)"}})]}),e.jsxs("div",{className:"flex-1 border-b py-3.5 pl-2",style:{borderColor:"rgba(80,100,70,0.06)"},children:[e.jsxs("p",{className:"mb-1 text-[9.5px] tracking-[0.07em] text-[#8a9a88]",children:["??",n?e.jsx("span",{className:"ml-1 align-middle text-[11px] text-[#8a7050]",children:"â™¥"}):null]}),e.jsx("p",{className:"mb-1 text-[14px] font-semibold leading-[1.35] text-[#2a2818]",style:{fontFamily:O},children:t.title}),e.jsx("p",{className:"text-[12px] leading-[1.7] text-[#7a8870]",children:t.snippet})]})]},t.name)})]})]})]}),b==="reading"&&e.jsx("div",{className:"relative flex min-h-0 flex-1 flex-col overflow-hidden",style:{backgroundImage:"repeating-linear-gradient(to bottom, transparent, transparent 31px, rgba(80,100,70,0.045) 31px, rgba(80,100,70,0.045) 32px)",backgroundPositionY:108},children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pointer-events-none absolute bottom-0 left-[52px] top-0 z-[1] w-px",style:{background:"rgba(90,112,96,0.11)"}}),e.jsx("div",{className:"pointer-events-none absolute left-[10px] top-[72px] z-[2] text-[8px] tracking-[0.08em]",style:{color:"rgba(90,112,96,0.3)",writingMode:"vertical-rl"},children:o.parsedDate?String(o.parsedDate.getFullYear()):"??"}),e.jsxs("div",{className:"relative z-[2] shrink-0 border-b px-[18px] pb-3 pt-4",style:{borderColor:"rgba(80,100,70,0.08)",paddingLeft:60},children:[e.jsxs("div",{className:"mb-1.5 flex items-center gap-2.5",children:[e.jsx("div",{className:"text-[26px] font-extrabold leading-none tracking-[-0.04em] text-[#5a7060]",children:o.parsedDate?o.parsedDate.getDate():"??"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[8.5px] uppercase tracking-[0.14em] text-[#8a9a88]",children:o.parsedDate?Ge[o.parsedDate.getDay()]:"UNKNOWN"}),e.jsx("span",{className:"text-[9.5px] tracking-[0.1em] text-[#8a9a88]",children:o.parsedDate?`${je[o.parsedDate.getMonth()]} ${o.parsedDate.getFullYear()}`:"??"})]}),e.jsx("button",{type:"button",onClick:()=>_e(o.name),className:"ml-auto px-1 text-[17px] leading-none",style:{color:j.has(o.name)?"#a04040":"rgba(90,112,96,0.32)"},"aria-label":"åˆ‡æ›æ”¶è—",children:j.has(o.name)?"â™¥":"â™¡"}),e.jsx("button",{type:"button",onClick:()=>Ee(t=>!t),className:"rounded-md px-1.5 py-0.5 text-[11px] font-semibold tracking-tight transition",style:{color:P?"#5a7060":"rgba(90,112,96,0.45)",background:P?"rgba(90,112,96,0.1)":"transparent",border:P?"1px solid rgba(90,112,96,0.22)":"1px solid transparent"},"aria-label":"å­—å‹è¨­å®š",children:"Aa"}),_&&e.jsxs("div",{className:"rounded-full px-2.5 py-0.5 text-[10.5px]",style:{background:"rgba(90,112,96,0.07)",color:"#8a9a88"},children:[ae+1," / ",f.length]})]}),e.jsx("h2",{className:"text-[17px] leading-[1.35] text-[#2a2818]",style:{fontFamily:O},children:o.title}),P&&e.jsxs("div",{className:"mt-3 space-y-3 rounded-xl border p-3",style:{background:"rgba(255,255,255,0.82)",borderColor:"rgba(80,100,70,0.14)"},"data-mdiary-no-tab-swipe":"true",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1.5 text-[12px] text-[#5a7060]",children:"å­—é«”ä¾†æº"}),e.jsx("div",{className:"flex gap-2",children:["default","diary"].map(t=>e.jsx("button",{type:"button",onClick:()=>{ze(t),typeof window<"u"&&window.localStorage.setItem(Se,t)},className:"flex-1 rounded-md border py-1 text-[11px] transition",style:{color:K===t?"#5a7060":"#8a9a88",background:K===t?"rgba(90,112,96,0.1)":"transparent",borderColor:K===t?"rgba(90,112,96,0.3)":"rgba(90,112,96,0.15)"},children:t==="default"?"é è¨­":"è·Ÿéš¨Mæ—¥è¨˜"},t))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-[12px] text-[#5a7060]",children:"å­—ç´š"}),e.jsxs("p",{className:"text-[11px] text-[#8a9a88]",children:[A.toFixed(1),"px"]})]}),e.jsx("input",{type:"range",min:12,max:22,step:.5,value:A,onChange:t=>w({mDiaryContentFontSize:Number(t.target.value)}),className:"mt-1.5 w-full accent-[#5a7060]"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-[12px] text-[#5a7060]",children:"è¡Œè·"}),e.jsx("p",{className:"text-[11px] text-[#8a9a88]",children:R.toFixed(2)})]}),e.jsx("input",{type:"range",min:1.5,max:2.8,step:.02,value:R,onChange:t=>w({mDiaryLineHeight:Number(t.target.value)}),className:"mt-1.5 w-full accent-[#5a7060]"})]})]})]}),e.jsxs("div",{className:"relative z-[2] min-h-0 flex-1 overflow-y-auto px-[18px] pb-2 pt-3",style:{paddingLeft:60},children:[o.htmlContent?e.jsx("div",{className:"text-[#3a3828]",style:{fontSize:A,lineHeight:R,fontFamily:me,whiteSpace:"normal"},dangerouslySetInnerHTML:{__html:o.htmlContent}}):e.jsx("p",{className:"whitespace-pre-wrap text-[#3a3828]",style:{fontSize:A,lineHeight:R,fontFamily:me},children:o.text||"ï¼ˆç©ºç™½å…§å®¹ï¼‰"}),e.jsx("div",{className:"pointer-events-none sticky bottom-0 left-0 right-0 h-14",style:{background:"linear-gradient(to bottom, transparent, #f6f2ea)"}})]}),e.jsx("div",{className:"shrink-0 border-t px-6 pb-2 pt-2",style:{borderColor:"rgba(80,100,70,0.07)"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{type:"button",onClick:()=>ne(-1),className:"px-1.5 text-[20px]",style:{color:"rgba(80,100,70,0.3)"},"aria-label":"ä¸Šä¸€ç¯‡",children:"â†"}),e.jsx("span",{className:"text-[11px] tracking-[0.1em]",style:{color:"rgba(80,100,70,0.4)"},children:o.parsedDate?`${o.parsedDate.getFullYear()}å¹´ ${o.parsedDate.getMonth()+1}æœˆ`:"æœªçŸ¥æ™‚åˆ»"}),e.jsx("button",{type:"button",onClick:()=>ne(1),className:"px-1.5 text-[20px]",style:{color:"rgba(80,100,70,0.3)"},"aria-label":"ä¸‹ä¸€ç¯‡",children:"â†’"})]})}),e.jsx("div",{ref:Re,className:"shrink-0 overflow-x-auto border-t px-[18px] pb-4 pt-2","data-mdiary-no-tab-swipe":"true",style:{borderColor:"rgba(80,100,70,0.05)",scrollbarWidth:"none"},children:e.jsx("div",{className:"flex gap-[7px]",children:f.map(t=>{const n=t.name===o.name;return e.jsxs("button",{id:`m-diary-chip-${encodeURIComponent(t.name)}`,type:"button",onClick:()=>E(t.name),className:"min-w-11 shrink-0 rounded-[10px] px-[7px] py-[5px]",style:{background:n?"rgba(90,112,96,0.1)":"transparent",border:n?"1.5px solid rgba(90,112,96,0.22)":"1.5px solid transparent"},children:[e.jsx("div",{className:"text-[13px] font-semibold leading-none",style:{color:n?"#5a7060":"#3a3828"},children:t.parsedDate?t.parsedDate.getDate():"??"}),e.jsx("div",{className:"mt-0.5 text-[7.5px]",style:{color:"#8a9a88"},children:t.parsedDate?je[t.parsedDate.getMonth()]:"??"}),e.jsx("div",{className:"mx-auto mt-[3px] h-1 w-1 rounded-full",style:{background:j.has(t.name)?"#a04040":"rgba(90,112,96,0.45)"}})]},t.name)})})})]}):e.jsx("div",{className:"grid flex-1 place-items-center px-6 text-center text-sm text-[#8a9a88]",children:"ç›®å‰æ²’æœ‰å¯é–±è®€çš„æ—¥è¨˜ï¼Œå…ˆåˆ°è¨­å®šé åŒ¯å…¥ `txt` æˆ– `docx`ã€‚"})}),(b==="random"||b==="reading"&&J)&&e.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 z-20 flex items-end justify-end pb-4 pr-5",children:e.jsx("button",{type:"button",onClick:()=>z(!0),className:"pointer-events-auto transition active:scale-90","aria-label":"Mæ—¥è¨˜è¨­å®š",children:de?e.jsx("img",{src:de,alt:"",draggable:!1,className:"calendar-chibi select-none drop-shadow-md",style:{width:b==="reading"?H:I,height:"auto"}}):e.jsx("span",{style:{width:b==="reading"?H:I,height:Math.round((b==="reading"?H:I)*1.17),borderRadius:20,background:"rgba(236,244,236,0.88)",border:"1.5px dashed rgba(90,120,90,0.18)",display:"grid",placeItems:"center",fontSize:52},children:"ğŸŒ¿"})})}),ce&&e.jsx("div",{className:"absolute inset-0 z-30 flex items-end bg-black/20",onClick:()=>z(!1),children:e.jsxs("div",{className:"w-full rounded-t-[26px] bg-[#f6f2ea] pb-10",style:{boxShadow:"0 -10px 48px rgba(40,60,40,0.18)"},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"mx-auto mt-3 h-1 w-[34px] rounded bg-[rgba(80,100,70,0.15)]"}),e.jsx("div",{className:"border-b px-6 py-4",style:{borderColor:"rgba(80,100,70,0.08)"},children:e.jsx("p",{className:"text-center text-sm font-semibold text-[#5a7060]",children:"M çš„æ—¥è¨˜"})}),e.jsxs("div",{className:"space-y-2 px-6 py-4",children:[e.jsx(se,{title:"é¡¯ç¤ºç¸½ç¯‡æ•¸",subtitle:"é¦–é  / æ™‚é–“æµ / é–±è®€é¡¯ç¤ºçµ±è¨ˆ",isOpen:ee.count,onToggle:()=>te(t=>({...t,count:!t.count})),className:"rounded-xl border border-[rgba(80,100,70,0.14)] bg-[rgba(255,255,255,0.75)] px-3 py-2.5",titleClassName:"text-[14px] text-[#2a2818]",subtitleClassName:"text-[10.5px] text-[#8a9a88]",bodyClassName:"mt-2",children:e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-[rgba(80,100,70,0.14)] bg-white/85 px-3 py-2.5",children:[e.jsx("p",{className:"text-xs text-[#5a7060]",children:"é¡¯ç¤ºç¸½ç¯‡æ•¸"}),e.jsx("button",{type:"button",onClick:()=>w({mDiaryShowCount:!_}),className:"relative h-[22px] w-[40px] rounded-full transition",style:{background:_?"#5a7060":"rgba(120,120,120,0.35)"},"aria-label":"åˆ‡æ›é¡¯ç¤ºç¯‡æ•¸",children:e.jsx("span",{className:"absolute top-0.5 h-[18px] w-[18px] rounded-full bg-white shadow",style:{left:_?20:2}})})]})}),e.jsxs(se,{title:"æ–‡å­—æ’ç‰ˆ",subtitle:"è¡Œè·èˆ‡å…§æ–‡å­—ç´š",isOpen:ee.text,onToggle:()=>te(t=>({...t,text:!t.text})),className:"rounded-xl border border-[rgba(80,100,70,0.14)] bg-[rgba(255,255,255,0.75)] px-3 py-2.5",titleClassName:"text-[14px] text-[#2a2818]",subtitleClassName:"text-[10.5px] text-[#8a9a88]",bodyClassName:"mt-2 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[13px] text-[#2a2818]",children:"è¡Œè·è¨­å®š"}),e.jsxs("p",{className:"mt-0.5 text-[10.5px] text-[#8a9a88]",children:["ç›®å‰ï¼š",R.toFixed(2)," å€"]}),e.jsx("input",{type:"range",min:1.5,max:2.8,step:.02,value:R,onChange:t=>w({mDiaryLineHeight:Number(t.target.value)}),className:"mt-2 w-full accent-[#5a7060]"}),e.jsxs("div",{className:"mt-1 flex justify-between text-[10px] text-[#8a9a88]",children:[e.jsx("span",{children:"ç·Šå¯†"}),e.jsx("span",{children:"å¯¬é¬†"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[13px] text-[#2a2818]",children:"å…§æ–‡å­—ç´š"}),e.jsxs("p",{className:"mt-0.5 text-[10.5px] text-[#8a9a88]",children:["ç›®å‰ï¼š",A.toFixed(1),"px"]}),e.jsx("input",{type:"range",min:12,max:22,step:.5,value:A,onChange:t=>w({mDiaryContentFontSize:Number(t.target.value)}),className:"mt-2 w-full accent-[#5a7060]"}),e.jsxs("div",{className:"mt-1 flex justify-between text-[10px] text-[#8a9a88]",children:[e.jsx("span",{children:"å°ä¸€é»"}),e.jsx("span",{children:"å¤§ä¸€é»"})]})]})]}),e.jsxs(se,{title:"M",subtitle:"å°é¢èˆ‡é–±è®€é å¤§å°",isOpen:ee.chibi,onToggle:()=>te(t=>({...t,chibi:!t.chibi})),className:"rounded-xl border border-[rgba(80,100,70,0.14)] bg-[rgba(255,255,255,0.75)] px-3 py-2.5",titleClassName:"text-[14px] text-[#2a2818]",subtitleClassName:"text-[10.5px] text-[#8a9a88]",bodyClassName:"mt-2 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[13px] text-[#2a2818]",children:"å°é¢M"}),e.jsxs("p",{className:"mt-0.5 text-[10.5px] text-[#8a9a88]",children:["ç›®å‰ï¼š",I,"px"]}),e.jsx("input",{type:"range",min:104,max:196,step:1,value:I,onChange:t=>w({mDiaryRandomChibiWidth:Number(t.target.value)}),className:"mt-2 w-full accent-[#5a7060]"}),e.jsxs("div",{className:"mt-1 flex justify-between text-[10px] text-[#8a9a88]",children:[e.jsx("span",{children:"å°ä¸€é»"}),e.jsx("span",{children:"å¤§ä¸€é»"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("p",{className:"text-[13px] text-[#2a2818]",children:"é–±è®€é M"}),e.jsx("button",{type:"button",onClick:()=>w({mDiaryShowReadingChibi:!J}),className:"relative h-[22px] w-[40px] rounded-full transition",style:{background:J?"#5a7060":"rgba(120,120,120,0.35)"},"aria-label":"åˆ‡æ›é–±è®€é Mé¡¯ç¤º",children:e.jsx("span",{className:"absolute top-0.5 h-[18px] w-[18px] rounded-full bg-white shadow",style:{left:J?20:2}})})]}),e.jsxs("p",{className:"mt-0.5 text-[10.5px] text-[#8a9a88]",children:["ç›®å‰ï¼š",H,"px"]}),e.jsx("input",{type:"range",min:104,max:196,step:1,value:H,onChange:t=>w({mDiaryReadingChibiWidth:Number(t.target.value)}),className:"mt-2 w-full accent-[#5a7060]"}),e.jsxs("div",{className:"mt-1 flex justify-between text-[10px] text-[#8a9a88]",children:[e.jsx("span",{children:"å°ä¸€é»"}),e.jsx("span",{children:"å¤§ä¸€é»"})]})]})]})]})]})})]})}export{bt as MDiaryPage,bt as default};
