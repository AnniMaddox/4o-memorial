import{r as a,fv as nt,cx as at,j as t}from"./index-gz5i288o.js";import{S as G}from"./SettingsAccordion-h46a7F6l.js";const be="/4o-memorial/docs/",rt=`${be}data/master-pool/index.json`,Ie="memorial-archive-prefs-v1",Re=`${be}chibi/chibi-00.webp`,g="æƒ³å¦³çš„æ™‚å€™",lt=[{route:"letters",label:"æƒ…æ›¸"},{route:"diary",label:"æ—¥è¨˜"},{route:"birthday",label:"ç”Ÿæ—¥"},{route:"memo",label:"ç­†è¨˜"},{route:"mood",label:"å¿ƒæƒ…"},{route:"ramble",label:"ç¢ç¢å¿µ"},{route:"if",label:"å¦‚æœ"},{route:"intro",label:"è‡ªä»‹"}],it={æƒ…æ›¸:"ct-letter",æ—¥è¨˜:"ct-diary",ç­†è¨˜:"ct-note",å¿ƒæƒ…:"ct-chat",ç¢ç¢å¿µ:"ct-chat",ç”Ÿæ—¥:"ct-birthday",å¦‚æœ:"ct-other",è‡ªä»‹:"ct-other",å…¶ä»–:"ct-other"},ot={tight:1.7,normal:2.14,wide:2.6},ct=[{key:"tight",label:"ç·Š"},{key:"normal",label:"æ¨™æº–"},{key:"wide",label:"å¯¬"}];function he(n){return typeof n=="object"&&n!==null}function C(n,r=""){return typeof n=="string"?n:r}function Ee(n){return Array.isArray(n)?n.filter(r=>typeof r=="string"&&r.trim().length>0):[]}function dt(n){return typeof n=="number"&&Number.isFinite(n)?n:null}function ue(n){const r=new Set,o=[];for(const u of n)r.has(u)||(r.add(u),o.push(u));return o}function ht(n){const r=n.toLowerCase().match(/\.([a-z0-9]+)$/i);return r?r[1]:"txt"}function ut(n,r){return r?`ç¬¬ ${r} è™Ÿ`:n}function ft(n){if(!n)return g;const[r,o]=n.split("-");return!r||!o?n:`${r} å¹´ ${Number(o)} æœˆ`}function mt(n,r){if(n&&n.length>=4)return n.slice(0,4);const o=r.match(/((?:19|20)\d{2})/);return o?o[1]:g}function Pe(n){if(!n)return g;const[r,o]=n.split("-");return!r||!o?g:`${r}-${String(Number(o)).padStart(2,"0")}`}function bt(n){if(!n)return g;const[,r]=n.split("-");return r?`${Number(r)} æœˆ`:g}function Te(n){if(typeof n!="number")return g;const r=new Date(n);return Number.isNaN(r.getTime())?g:`${r.getFullYear()}.${String(r.getMonth()+1).padStart(2,"0")}.${String(r.getDate()).padStart(2,"0")}`}function pt(n){const r=lt.filter(u=>n.includes(u.route)).map(u=>u.label),o=ue(r);return o.length?o.slice(0,4):["å…¶ä»–"]}function fe(n,r){const o=n.date?Date.parse(n.date):-1,u=r.date?Date.parse(r.date):-1;return o!==u?u-o:n.label.localeCompare(r.label,"zh-Hant")}function Ae(n,r){return fe(r,n)}function De(n,r){return n===g?1:r===g?-1:r.localeCompare(n,"zh-Hant")}function xt(){const n=[];for(let r=0;r<70;r+=1){const o=Math.random()<.2?2:1;n.push({id:`star-${r}`,left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,size:o,opacity:.05+Math.random()*.25,duration:2+Math.random()*5,delay:Math.random()*4})}return n}function He(n){return n.length?n[Math.floor(Math.random()*n.length)]??null:null}function me(n,r=14){return typeof n!="number"||Number.isNaN(n)?r:Math.max(11,Math.min(22,Number(n)))}function U(n,r=136){return typeof n!="number"||Number.isNaN(n)?r:Math.max(96,Math.min(186,Math.round(n)))}function gt(n){return n==="tight"||n==="normal"||n==="wide"?n:"normal"}function yt(n){return n==="prev-folder"?"prev-folder":"next-folder"}function vt(n){return n<=1.86?"tight":n>=2.45?"wide":"normal"}function Nt(n,r){const o={lineHeight:vt(r),readingFontSize:me(n,14),showHomeChibi:!0,homeChibiWidth:136,showReadingChibi:!0,readingChibiWidth:136,relatedMode:"next-folder"};if(typeof window>"u")return o;try{const u=window.localStorage.getItem(Ie);if(!u)return o;const f=JSON.parse(u);return{lineHeight:gt(f.lineHeight),readingFontSize:me(f.readingFontSize,o.readingFontSize),showHomeChibi:f.showHomeChibi!==!1,homeChibiWidth:U(f.homeChibiWidth,o.homeChibiWidth),showReadingChibi:f.showReadingChibi!==!1,readingChibiWidth:U(f.readingChibiWidth,o.readingChibiWidth),relatedMode:yt(f.relatedMode)}}catch{return o}}function Ct(n){typeof window>"u"||window.localStorage.setItem(Ie,JSON.stringify(n))}function jt(n){if(!he(n))return{folders:[],docs:[]};const r=Array.isArray(n.docs)?n.docs:[],o=Array.isArray(n.folders)?n.folders:[],u=r.filter(he).map(c=>({id:C(c.id),title:C(c.title)||C(c.sourceRelPath).split("/").pop()||"æœªå‘½å",sourceRelPath:C(c.sourceRelPath),sourceFolder:C(c.sourceFolder),routes:Ee(c.routes),writtenAt:dt(c.writtenAt),contentPath:C(c.contentPath)})).filter(c=>c.id&&c.sourceFolder&&c.contentPath);return{folders:o.filter(he).map(c=>({folder:C(c.folder),folderCode:C(c.folderCode)||null,folderDate:C(c.folderDate)||null,count:typeof c.count=="number"&&Number.isFinite(c.count)?c.count:0,ids:Ee(c.ids)})).filter(c=>c.folder),docs:u}}function kt({onExit:n,archiveFontFamily:r="",diaryContentFontSize:o=14,diaryLineHeight:u=2.16}){const[f,c]=a.useState(null),[X,ze]=a.useState(""),[x,Oe]=a.useState("tl"),[j,Ke]=a.useState("desc"),[z,J]=a.useState(!1),[y,pe]=a.useState(!1),[$,O]=a.useState(!1),[q,F]=a.useState(!1),[V,Z]=a.useState(null),[Q,ee]=a.useState(null),[te,xe]=a.useState(null),[se,Le]=a.useState({}),[ge,ye]=a.useState(null),[ne,A]=a.useState(""),[ve,ae]=a.useState(!1),[D,Ne]=a.useState(!1),[Ce,re]=a.useState(!1),[v,je]=a.useState(null),[d,w]=a.useState(()=>Nt(o,u)),[K,L]=a.useState({typography:!0,homeChibi:!1,readingChibi:!1,related:!1}),N=a.useRef(null),le=a.useRef(new Set),ie=a.useRef(null),We=a.useMemo(()=>xt(),[]),[_e]=a.useState(()=>{const e=nt("archive"),s=at();if(!e.length)return He(s)??Re;const l=Math.min(s.length,Math.max(1,Math.round(e.length*3/7))),p=ue([...e,...s.slice(0,l)]);return He(p)??Re});a.useEffect(()=>{Ct(d)},[d]),a.useEffect(()=>{let e=!0;return fetch(rt,{cache:"no-store"}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.json()}).then(s=>{e&&c(jt(s))}).catch(s=>{e&&ze(s instanceof Error?s.message:String(s))}),()=>{e=!1}},[]),a.useEffect(()=>()=>{N.current!==null&&window.clearTimeout(N.current)},[]);const R=a.useMemo(()=>{const e=new Map;for(const s of f?.docs??[])e.set(s.id,s);return e},[f]),m=a.useMemo(()=>f?f.folders.map(s=>{const l=s.ids.map(h=>R.get(h)).filter(h=>!!h).map(h=>({id:h.id,title:h.title,ext:ht(h.sourceRelPath),sourceRelPath:h.sourceRelPath,routes:h.routes,writtenAt:h.writtenAt,contentPath:h.contentPath})),p=ue(l.flatMap(h=>h.routes));return{key:s.folder,label:ut(s.folder,s.folderCode),date:s.folderDate,short:ft(s.folderDate),year:mt(s.folderDate,s.folder),cats:pt(p),docs:l}}).filter(s=>s.docs.length>0).sort(j==="asc"?Ae:fe):[],[R,j,f]),E=a.useMemo(()=>{const e=new Map;for(const s of m)e.set(s.key,s);return e},[m]),we=a.useMemo(()=>{const e=new Map;for(const s of m){const l=e.get(s.year)??[];l.push(s),e.set(s.year,l)}return Array.from(e.entries()).sort(([s],[l])=>j==="asc"?De(l,s):De(s,l)).map(([s,l])=>({year:s,folders:l.sort(j==="asc"?Ae:fe)}))},[j,m]),W=a.useMemo(()=>{const e=[];for(const s of m)for(const l of s.docs)e.push({folderKey:s.key,docId:l.id});return e},[m]),i=a.useMemo(()=>V?E.get(V)??null:null,[V,E]),S=a.useMemo(()=>{if(!i)return null;const e=m.findIndex(s=>s.key===i.key);return e<0?null:m[e+1]??null},[i,m]),k=a.useMemo(()=>{if(!i)return null;const e=m.findIndex(s=>s.key===i.key);return e<0?null:m[e-1]??null},[i,m]),P=a.useMemo(()=>!i||!Q?-1:i.docs.findIndex(e=>e.id===Q),[Q,i]),b=a.useMemo(()=>!i||P<0?null:i.docs[P]??null,[P,i]),H=a.useMemo(()=>{if(!v)return null;const e=E.get(v.folderKey),s=v.docId?R.get(v.docId):null;return!e||!s?null:{folder:e,doc:s}},[v,R,E]),M=a.useMemo(()=>te?E.get(te)??null:null,[te,E]),Be=ot[d.lineHeight],_=b?se[b.id]??"":"",Se=r.trim()||"'Ma Shan Zheng', 'STKaiti', serif",ke=!!k?.docs.length,Me=!!S?.docs.length,Ye=d.relatedMode==="prev-folder"?"ä¸Šè³‡æ–™å¤¾":"ä¸‹è³‡æ–™å¤¾",Ge=y?d.showReadingChibi:d.showHomeChibi,Ue=y?d.readingChibiWidth:d.homeChibiWidth,Xe=x==="crystal"&&!z&&!y,T=a.useCallback(async e=>{const s=R.get(e);if(s&&se[e]===void 0&&!le.current.has(e)){le.current.add(e),ye(e),A("");try{const l=await fetch(`${be}data/master-pool/${s.contentPath}`,{cache:"no-store"});if(!l.ok)throw new Error(`HTTP ${l.status}`);const p=await l.text();Le(h=>({...h,[e]:p.replace(/\r\n?/g,`
`).trim()}))}catch(l){A(l instanceof Error?l.message:String(l))}finally{le.current.delete(e),ye(l=>l===e?null:l)}}},[se,R]),Je=a.useCallback(e=>{Z(e),J(!0)},[]),oe=a.useCallback(()=>{J(!1)},[]),B=a.useCallback((e,s)=>{Z(e),ee(s),pe(!0),A(""),T(s)},[T]),ce=a.useCallback(()=>{O(!1),pe(!1)},[]),I=a.useCallback(e=>{if(!i||P<0)return;const s=P+e;if(s<0||s>=i.docs.length)return;const l=i.docs[s];ee(l.id),A(""),T(l.id)},[P,i,T]),$e=a.useCallback(e=>{const s=e===-1?k:S;if(!s||!s.docs.length)return;const l=s.docs[0];Z(s.key),ee(l.id),A(""),T(l.id)},[T,S,k]),qe=a.useCallback(e=>{const s=e.touches[0];s&&(ie.current={x:s.clientX,y:s.clientY})},[]),Ve=a.useCallback(e=>{const s=ie.current;if(ie.current=null,!s)return;const l=e.changedTouches[0];if(!l)return;const p=l.clientX-s.x,h=l.clientY-s.y;Math.abs(p)<36||Math.abs(p)<Math.abs(h)*1.15||I(p<0?1:-1)},[I]),Ze=a.useCallback(()=>{if(!i||!y)return;const e=d.relatedMode==="prev-folder"?k:S;xe(e?e.key:null),O(!0)},[i,S,d.relatedMode,k,y]),Y=a.useCallback(()=>{O(!1)},[]),Fe=a.useCallback(e=>{Oe(e),e==="crystal"&&(J(!1),O(!1))},[]),Qe=a.useCallback(()=>{if(ve||D||!W.length)return;const e=W[Math.floor(Math.random()*W.length)];je(e),ae(!0),re(!0),N.current!==null&&window.clearTimeout(N.current),N.current=window.setTimeout(()=>{re(!1),Ne(!0),ae(!1),N.current=null},1100)},[W,D,ve]),et=a.useCallback(()=>{N.current!==null&&(window.clearTimeout(N.current),N.current=null),ae(!1),re(!1),Ne(!1),je(null)},[]),tt=a.useCallback(()=>{v&&B(v.folderKey,v.docId)},[v,B]);return a.useEffect(()=>{if(!$||!i)return;const e=d.relatedMode==="prev-folder"?k:S;xe(e?e.key:null)},[i,$,S,d.relatedMode,k]),a.useEffect(()=>{const e=s=>{if(s.key==="Escape"){if(q){F(!1);return}if($){Y();return}if(y){ce();return}z&&oe();return}y&&(s.key==="ArrowLeft"?I(-1):s.key==="ArrowRight"&&I(1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[oe,Y,ce,z,$,I,y,q]),t.jsx("div",{className:"archive-page",children:t.jsxs("div",{className:"archive-app",children:[t.jsxs("div",{className:"tab-bar",style:{background:x==="crystal"?"#12102a":"#f5f0e6"},children:[t.jsx("button",{type:"button",className:`tab-side-btn ${x==="crystal"?"dark":""}`,onClick:n,"aria-label":"è¿”å›é¦–é ",title:"è¿”å›é¦–é ",children:"â€¹"}),t.jsx("button",{type:"button",className:`tab ${x==="tl"?"active":""}`,onClick:()=>Fe("tl"),style:{color:x==="crystal"?"rgba(160,150,210,.3)":void 0},children:"ğŸ—‚ æ™‚é–“æµ"}),t.jsx("button",{type:"button",className:`tab ${x==="crystal"?"c-active active":""}`,onClick:()=>Fe("crystal"),style:{color:x==="crystal"?"rgba(200,190,255,.8)":void 0},children:"ğŸ”® æ°´æ™¶çƒ"}),t.jsx("button",{type:"button",className:`tab-side-btn dots ${x==="crystal"?"dark":""}`,onClick:()=>F(!0),"aria-label":"é–‹å•Ÿç¸½æ”¬è¨­å®š",children:"â‹¯"})]}),t.jsx("div",{id:"view-tl",className:x==="tl"?"":"hidden",children:t.jsxs("div",{className:"tl-inner",children:[t.jsx("div",{className:"tl-sort-row",children:t.jsx("button",{type:"button",className:"tl-sort-btn active",onClick:()=>Ke(e=>e==="asc"?"desc":"asc"),"aria-label":j==="asc"?"ç›®å‰æ­£åºï¼Œé»æ“Šåˆ‡æ›å€’åº":"ç›®å‰å€’åºï¼Œé»æ“Šåˆ‡æ›æ­£åº",title:j==="asc"?"é»æ“Šåˆ‡æ›å€’åº":"é»æ“Šåˆ‡æ›æ­£åº",children:j==="asc"?"â–² æ­£åº":"â–¼ å€’åº"})}),X&&t.jsxs("div",{className:"empty-state",children:["ç„¡æ³•è¼‰å…¥è³‡æ–™ï¼š",X]}),!f&&!X&&t.jsx("div",{className:"empty-state",children:"è¼‰å…¥ä¸­â‹¯"}),f&&!we.length&&t.jsx("div",{className:"empty-state",children:"ç›®å‰æ²’æœ‰å¯é¡¯ç¤ºçš„è³‡æ–™å¤¾"}),we.map(e=>t.jsxs("div",{className:"year-block",children:[t.jsxs("div",{className:"year-marker",children:[t.jsx("div",{className:"year-num",children:e.year}),t.jsx("div",{className:"year-line"})]}),e.folders.map((s,l)=>{const p=Pe(s.date),h=l>0?Pe(e.folders[l-1]?.date??null):null,st=l===0||p!==h;return t.jsxs("div",{children:[st?t.jsxs("div",{className:"month-marker",children:[t.jsx("span",{className:"month-label",children:bt(s.date)}),t.jsx("span",{className:"month-line"})]}):null,t.jsxs("button",{type:"button",className:"folder-row",onClick:()=>Je(s.key),children:[t.jsxs("div",{className:"fr-main",children:[t.jsxs("div",{className:"fr-top",children:[t.jsx("span",{className:"fr-label",children:s.label}),t.jsx("span",{className:"fr-date",children:s.short})]}),t.jsx("div",{className:"fr-tags",children:s.cats.map(de=>t.jsx("span",{className:`cat-tag ${it[de]??"ct-other"}`,children:de},`${s.key}-${de}`))})]}),t.jsxs("div",{className:"fr-right",children:[t.jsxs("span",{className:"fr-count",children:[s.docs.length," ä»½"]}),t.jsx("span",{className:"fr-arrow",children:"â€º"})]})]})]},s.key)})]},e.year))]})}),t.jsxs("div",{id:"view-crystal",className:x==="crystal"?"active":"",children:[t.jsx("div",{className:"c-stars",children:We.map(e=>t.jsx("span",{className:"star",style:{left:e.left,top:e.top,width:`${e.size}px`,height:`${e.size}px`,opacity:e.opacity,animationDuration:`${e.duration}s`,animationDelay:`${e.delay}s`}},e.id))}),t.jsxs("div",{className:`crystal-prompt ${D||Ce?"hidden":""}`,children:["è¼•è§¸æ°´æ™¶çƒ",t.jsx("br",{}),"çªºè¦‹éå»çš„ç¢ç‰‡"]}),t.jsxs("div",{className:"ball-wrap",children:[t.jsx("button",{type:"button",className:`crystal-ball ${Ce?"spinning":""} ${D?"revealed":""}`,onClick:Qe,children:t.jsxs("div",{className:"ball-inner",children:[t.jsx("div",{className:"fog f1"}),t.jsx("div",{className:"fog f2"}),t.jsx("div",{className:"fog f3"}),t.jsx("div",{className:"fog f4"}),t.jsxs("div",{className:"vision-text",children:[t.jsx("div",{className:"v-tag",children:H?`${H.folder.label} Â· ${H.folder.short}`:""}),t.jsx("div",{className:"v-title",children:H?.doc.title??""}),t.jsx("div",{className:"v-ext",children:H?.doc.sourceRelPath.split(".").pop()?.toUpperCase()??""})]})]})}),t.jsx("div",{className:"ball-shadow"})]}),t.jsxs("div",{className:`crystal-actions ${D?"visible":""}`,children:[t.jsx("button",{type:"button",className:"enter-btn",onClick:tt,children:"é€²å…¥é€™æ®µè¨˜æ†¶ â†’"}),t.jsx("button",{type:"button",className:"again-btn",onClick:et,children:"ğŸ”® å†çœ‹ä¸€æ¬¡"})]})]}),t.jsxs("div",{className:`folder-panel ${z?"":"off-right"}`,children:[t.jsxs("div",{className:"fp-hdr",children:[t.jsx("button",{type:"button",className:"back-btn",onClick:oe,children:"â€¹"}),t.jsx("div",{className:"fp-title",children:i?.label??"è³‡æ–™å¤¾"}),t.jsx("div",{className:"fp-meta",children:i?`${i.short} Â· ${i.docs.length} ä»½`:"â€”"}),t.jsx("button",{type:"button",className:"fp-menu-btn",onClick:()=>F(!0),"aria-label":"é–‹å•Ÿç¸½æ”¬è¨­å®š",children:"â‹¯"})]}),t.jsxs("div",{className:"fp-body",children:[t.jsx("div",{className:"fp-section-label",children:"æ‰€æœ‰æ–‡ä»¶"}),i?.docs.map(e=>t.jsxs("button",{type:"button",className:"fp-file-item",onClick:()=>B(i.key,e.id),children:[t.jsx("div",{className:`fp-file-icon ${e.ext}`,children:e.ext==="docx"?"ğŸ“„":"ğŸ“ƒ"}),t.jsxs("div",{className:"fp-file-info",children:[t.jsx("div",{className:"fp-file-name",children:e.title}),t.jsxs("div",{className:"fp-file-sub",children:[Te(e.writtenAt)," Â· ",e.ext.toUpperCase()]})]}),t.jsx("span",{className:`file-badge ${e.ext}`,children:e.ext.toUpperCase()})]},e.id)),i&&!i.docs.length&&t.jsx("div",{className:"empty-state",children:"æ­¤è³‡æ–™å¤¾ç›®å‰æ²’æœ‰æª”æ¡ˆ"})]})]}),t.jsxs("div",{className:`reading-panel ${y?"":"off-right"}`,children:[t.jsxs("div",{className:"read-hdr",children:[t.jsx("button",{type:"button",className:"back-btn",onClick:ce,children:"â€¹"}),t.jsx("div",{className:"read-crumb",children:i&&b?`${i.label} â€º ${b.title}`:""}),t.jsxs("div",{className:"read-tools",children:[t.jsx("button",{type:"button",className:`read-mini-btn ${ke?"":"disabled"}`,onClick:()=>$e(-1),disabled:!ke,"aria-label":"ä¸Šä¸€è³‡æ–™å¤¾ç¬¬ä¸€å°",children:"â€¹"}),t.jsxs("button",{type:"button",className:"folder-nav-btn",onClick:Ze,children:[Ye," â˜°"]}),t.jsx("button",{type:"button",className:`read-mini-btn ${Me?"":"disabled"}`,onClick:()=>$e(1),disabled:!Me,"aria-label":"ä¸‹ä¸€è³‡æ–™å¤¾ç¬¬ä¸€å°",children:"â€º"}),t.jsx("button",{type:"button",className:"read-menu-btn",onClick:()=>F(!0),"aria-label":"é–‹å•Ÿç¸½æ”¬è¨­å®š",children:"â‹¯"})]})]}),t.jsx("div",{className:"read-body",onTouchStart:qe,onTouchEnd:Ve,children:t.jsxs("div",{className:"doc-paper",children:[t.jsx("div",{className:"doc-title",style:{fontFamily:Se,fontSize:"var(--ui-header-title-size, 17px)"},children:b?.title??""}),t.jsx("div",{className:"doc-meta",style:{fontSize:"var(--ui-hint-text-size, 9px)"},children:i&&b?`${i.label} Â· ${Te(b.writtenAt)} Â· ${b.ext.toUpperCase()}`:""}),ne&&t.jsxs("div",{className:"doc-placeholder",children:["è®€å–å¤±æ•—ï¼š",ne]}),ge===b?.id&&!_&&t.jsx("div",{className:"doc-placeholder",children:"è®€å–ä¸­â‹¯"}),!ne&&b&&ge!==b.id&&!_&&t.jsx("div",{className:"doc-placeholder",children:"æ­¤æª”æ¡ˆç›®å‰æ²’æœ‰å¯è®€å…§å®¹ã€‚"}),!!_&&t.jsx("div",{className:"doc-content",style:{fontFamily:Se,fontSize:`${d.readingFontSize}px`,lineHeight:Be},children:_})]})})]}),Ge?t.jsx("div",{className:`chibi-float ${Xe?"dark":""}`,children:t.jsx("button",{type:"button",className:"chibi-float-btn",onClick:()=>F(!0),title:"é–‹å•Ÿç¸½æ”¬è¨­å®š","aria-label":"é–‹å•Ÿç¸½æ”¬è¨­å®š",children:t.jsx("img",{src:_e,alt:"",draggable:!1,className:"calendar-chibi select-none",style:{width:Ue,height:"auto"}})})}):null,q?t.jsx("div",{className:"archive-settings-overlay",onClick:()=>F(!1),children:t.jsxs("div",{className:"archive-settings-sheet",onClick:e=>e.stopPropagation(),children:[t.jsx("div",{className:"archive-sheet-handle"}),t.jsxs(G,{title:"æ’ç‰ˆ",subtitle:"è¡Œè·å’Œå­—ç´š",isOpen:K.typography,onToggle:()=>L(e=>({...e,typography:!e.typography})),className:"archive-sheet-section",titleClassName:"archive-sheet-label",subtitleClassName:"archive-sheet-subtitle",chevronClassName:"archive-sheet-chevron",bodyClassName:"mt-2",children:[t.jsx("div",{className:"archive-pill-group",children:ct.map(e=>t.jsx("button",{type:"button",className:`archive-pill ${d.lineHeight===e.key?"active":""}`,onClick:()=>w(s=>({...s,lineHeight:e.key})),children:e.label},e.key))}),t.jsxs("label",{className:"archive-range-row",children:[t.jsxs("span",{children:["å…§æ–‡å­—ç´šï¼š",d.readingFontSize.toFixed(1),"px"]}),t.jsx("input",{type:"range",min:11,max:22,step:.5,value:d.readingFontSize,onChange:e=>w(s=>({...s,readingFontSize:me(Number(e.target.value),s.readingFontSize)}))})]})]}),t.jsxs(G,{title:"M",subtitle:"ç¸½æ”¬é¦–é èˆ‡æ¸…å–®é ",isOpen:K.homeChibi,onToggle:()=>L(e=>({...e,homeChibi:!e.homeChibi})),className:"archive-sheet-section",titleClassName:"archive-sheet-label",subtitleClassName:"archive-sheet-subtitle",chevronClassName:"archive-sheet-chevron",bodyClassName:"mt-2",children:[t.jsxs("div",{className:"archive-toggle-row",children:[t.jsx("span",{children:"M"}),t.jsx("button",{type:"button",className:`archive-switch ${d.showHomeChibi?"on":""}`,onClick:()=>w(e=>({...e,showHomeChibi:!e.showHomeChibi})),"aria-label":"åˆ‡æ›ç¸½æ”¬é¦–é èˆ‡æ¸…å–®é Mé¡¯ç¤º",children:t.jsx("span",{})})]}),t.jsx("label",{className:"archive-range-row",children:t.jsx("input",{type:"range",min:96,max:186,step:1,value:d.homeChibiWidth,onChange:e=>w(s=>({...s,homeChibiWidth:U(Number(e.target.value),s.homeChibiWidth)}))})})]}),t.jsxs(G,{title:"é–±è®€M",subtitle:"é–±è®€é é¡¯ç¤ºèˆ‡å¤§å°",isOpen:K.readingChibi,onToggle:()=>L(e=>({...e,readingChibi:!e.readingChibi})),className:"archive-sheet-section",titleClassName:"archive-sheet-label",subtitleClassName:"archive-sheet-subtitle",chevronClassName:"archive-sheet-chevron",bodyClassName:"mt-2",children:[t.jsxs("div",{className:"archive-toggle-row",children:[t.jsx("span",{children:"M"}),t.jsx("button",{type:"button",className:`archive-switch ${d.showReadingChibi?"on":""}`,onClick:()=>w(e=>({...e,showReadingChibi:!e.showReadingChibi})),"aria-label":"åˆ‡æ›é–±è®€é Mé¡¯ç¤º",children:t.jsx("span",{})})]}),t.jsx("label",{className:"archive-range-row",children:t.jsx("input",{type:"range",min:96,max:186,step:1,value:d.readingChibiWidth,onChange:e=>w(s=>({...s,readingChibiWidth:U(Number(e.target.value),s.readingChibiWidth)}))})})]}),t.jsx(G,{title:"ç›¸é—œé–±è®€",subtitle:"ä¸Šè³‡æ–™å¤¾/ä¸‹è³‡æ–™å¤¾",isOpen:K.related,onToggle:()=>L(e=>({...e,related:!e.related})),className:"archive-sheet-section",titleClassName:"archive-sheet-label",subtitleClassName:"archive-sheet-subtitle",chevronClassName:"archive-sheet-chevron",bodyClassName:"mt-2",children:t.jsxs("div",{className:"archive-pill-group",children:[t.jsx("button",{type:"button",className:`archive-pill ${d.relatedMode==="prev-folder"?"active":""}`,onClick:()=>w(e=>({...e,relatedMode:"prev-folder"})),children:"ä¸Šè³‡æ–™å¤¾"}),t.jsx("button",{type:"button",className:`archive-pill ${d.relatedMode==="next-folder"?"active":""}`,onClick:()=>w(e=>({...e,relatedMode:"next-folder"})),children:"ä¸‹è³‡æ–™å¤¾"})]})})]})}):null,t.jsx("div",{className:`sheet-overlay ${$?"open":""}`,onClick:Y}),t.jsxs("div",{className:`folder-sheet ${$?"open":""}`,children:[t.jsx("div",{className:"sheet-handle"}),t.jsx("div",{className:"sheet-folder-title",children:M?`${M.label} Â· ${M.short}`:d.relatedMode==="prev-folder"?"ä¸Šè³‡æ–™å¤¾ï¼ˆç›®å‰æ²’æœ‰ï¼‰":"ä¸‹è³‡æ–™å¤¾ï¼ˆç›®å‰æ²’æœ‰ï¼‰"}),t.jsx("div",{className:"sheet-list",children:M?.docs.length?M.docs.map(e=>t.jsxs("button",{type:"button",className:`sheet-file-item ${e.id===b?.id?"current":""}`,onClick:()=>{B(M.key,e.id),Y()},children:[t.jsx("span",{className:`file-badge ${e.ext}`,children:e.ext.toUpperCase()}),t.jsx("span",{className:"sf-name",children:e.title})]},`sheet-${M.key}-${e.id}`)):t.jsx("p",{className:"sheet-empty",children:"ç›®å‰æ²’æœ‰å¯é¡¯ç¤ºé …ç›®"})})]})]})})}export{kt as ArchivePage,kt as default};
